apiVersion: rule.example.com/v1alpha1
kind: OperationRule
metadata:
  name: alert-log-curator
  namespace: openshift-logging
spec:
  alertWebhook: true
  inference:
    rules:
    - when:
      - $alertWebhook.alertname == "CPUThrottlingHigh"
      - $alertWebhook.severity == "warning"
      then:
      - name: cron
        path: spec.jobTemplate.spec.template.spec.containers[0]
        value:
          alertname: $alertWebhook.alertname
          env: 'name: CURATOR_DEFAULT_DAYS, value: 10'
      - name: config
        path: data
        value:
          config.yaml: '
    .defaults:\n
      delete:\n
        days: 10'
  resources:
    cron:
      apiVersion: batch/v1beta1
      kind: CronJob
      name: curator
    config:
      apiVersion: v1
      kind: ConfigMap
      name: curator